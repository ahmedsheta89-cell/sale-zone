<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="test-pages.css">
    <title>ุงุฎุชุจุงุฑ ูุธุงู ุงูุชุดุงู ุงูุฃุฎุทุงุก</title>
</head>
<body>
    <div class="test-container">
        <h1>๐งช ุงุฎุชุจุงุฑ ูุธุงู ุงูุชุดุงู ุงูุฃุฎุทุงุก</h1>
        <p>ูุฐู ุงูุตูุญุฉ ูุงุฎุชุจุงุฑ ูุธุงู ุงูุชุดุงู ุงูุฃุฎุทุงุก ุงูุงุญุชุฑุงูู ูู ุงููุชุฌุฑ.</p>
        
        <div class="test-section">
            <h2>๐ด ุงุฎุชุจุงุฑ ุงูุฃุฎุทุงุก</h2>
            <button class="test-btn danger" onclick="testJavaScriptError()">ุฎุทุฃ JavaScript</button>
            <button class="test-btn danger" onclick="testPromiseRejection()">ุฑูุถ Promise</button>
            <button class="test-btn danger" onclick="testMissingElement()">ุนูุตุฑ ููููุฏ</button>
            <button class="test-btn danger" onclick="testNullReference()">ูุฑุฌุน null</button>
            <button class="test-btn danger" onclick="testTypeError()">ุฎุทุฃ ููุน</button>
        </div>
        
        <div class="test-section">
            <h2>๐ก ุงุฎุชุจุงุฑ ุงูุชุญุฐูุฑุงุช</h2>
            <button class="test-btn warning" onclick="testSlowLoad()">ุชุญููู ุจุทูุก</button>
            <button class="test-btn warning" onclick="testLocalStorageFull()">LocalStorage ููุชูุฆ</button>
            <button class="test-btn warning" onclick="testNetworkOffline()">ุดุจูุฉ ุบูุฑ ูุชุตูุฉ</button>
            <button class="test-btn warning" onclick="testSlowFirebase()">Firebase ุจุทูุก</button>
        </div>
        
        <div class="test-section">
            <h2>๐ ุงุฎุชุจุงุฑ ุงูุฃุฏุงุก</h2>
            <button class="test-btn" onclick="testPerformance()">ุงุฎุชุจุงุฑ ุงูุฃุฏุงุก</button>
            <button class="test-btn" onclick="testMemoryUsage()">ุงุณุชุฎุฏุงู ุงูุฐุงูุฑุฉ</button>
            <button class="test-btn" onclick="testUserActions()">ุฅุฌุฑุงุกุงุช ุงููุณุชุฎุฏู</button>
        </div>
        
        <div class="test-section">
            <h2>๐ง ุงุฎุชุจุงุฑ ุงูุชุนุงูู</h2>
            <button class="test-btn" onclick="testAutoRecovery()">ุงูุชุนุงูู ุงูุชููุงุฆู</button>
            <button class="test-btn" onclick="testElementRecreation()">ุฅุนุงุฏุฉ ุฅูุดุงุก ุงูุนูุงุตุฑ</button>
            <button class="test-btn" onclick="testFallbackMode()">ูุถุน ุงูุงุญุชูุงุท</button>
        </div>
        
        <div class="test-section">
            <h2>๐ ุนุฑุถ ุงูุชูุงุฑูุฑ</h2>
            <button class="test-btn" onclick="showSystemReport()">ุนุฑุถ ุชูุฑูุฑ ุงููุธุงู</button>
            <button class="test-btn" onclick="clearErrors()">ูุณุญ ุงูุฃุฎุทุงุก</button>
            <button class="test-btn" onclick="exportReport()">ุชุตุฏูุฑ ุงูุชูุฑูุฑ</button>
        </div>
        
        <div id="status" class="status info"></div>
        
        <div class="iframe-container">
            <h3>๐๏ธ ุงููุชุฌุฑ ุงููุฎุชุจุฑ</h3>
            <iframe src="https://ahmedsheta89-cell.github.io/sale-zone/ูุชุฌุฑ_2.HTML" title="ุงููุชุฌุฑ ุงูุฑุฆูุณู"></iframe>
        </div>
    </div>

    <script>
        // ๐ด ุงุฎุชุจุงุฑุงุช ุงูุฃุฎุทุงุก
        function testJavaScriptError() {
            showStatus('ุงุฎุชุจุงุฑ ุฎุทุฃ JavaScript...', 'info');
            setTimeout(() => {
                // ูุฐุง ุณูููุฏ ุฎุทุฃ JavaScript
                const obj = null;
                obj.someProperty = 'test'; // TypeError
            }, 100);
        }
        
        function testPromiseRejection() {
            showStatus('ุงุฎุชุจุงุฑ ุฑูุถ Promise...', 'info');
            setTimeout(() => {
                // ูุฐุง ุณูููุฏ ุฎุทุฃ Promise rejection
                Promise.reject('Test promise rejection').catch(() => {});
            }, 100);
        }
        
        function testMissingElement() {
            showStatus('ุงุฎุชุจุงุฑ ุนูุตุฑ ููููุฏ...', 'info');
            setTimeout(() => {
                // ูุฐุง ุณูููุฏ ุฎุทุฃ ุนูุตุฑ ููููุฏ
                const element = document.getElementById('nonExistentElement');
                element.innerHTML = 'test'; // TypeError
            }, 100);
        }
        
        function testNullReference() {
            showStatus('ุงุฎุชุจุงุฑ ูุฑุฌุน null...', 'info');
            setTimeout(() => {
                // ูุฐุง ุณูููุฏ ุฎุทุฃ ูุฑุฌุน null
                const data = null;
                console.log(data.property); // TypeError
            }, 100);
        }
        
        function testTypeError() {
            showStatus('ุงุฎุชุจุงุฑ ุฎุทุฃ ููุน...', 'info');
            setTimeout(() => {
                // ูุฐุง ุณูููุฏ ุฎุทุฃ ููุน
                const num = '123';
                num.toFixed(2); // TypeError
            }, 100);
        }
        
        // ๐ก ุงุฎุชุจุงุฑุงุช ุงูุชุญุฐูุฑุงุช
        function testSlowLoad() {
            showStatus('ุงุฎุชุจุงุฑ ุชุญููู ุจุทูุก...', 'info');
            // ูุญุงูุงุฉ ุชุญููู ุจุทูุก
            const start = performance.now();
            setTimeout(() => {
                const end = performance.now();
                const duration = end - start;
                if (duration > 2000) {
                    showStatus(`ุชู ุงูุชุดุงู ุชุญููู ุจุทูุก: ${duration.toFixed(2)}ms`, 'error');
                } else {
                    showStatus(`ุงูุชุญููู ุทุจูุนู: ${duration.toFixed(2)}ms`, 'success');
                }
            }, 2500);
        }
        
        function testLocalStorageFull() {
            showStatus('ุงุฎุชุจุงุฑ LocalStorage ููุชูุฆ...', 'info');
            try {
                // ูุญุงููุฉ ููุก LocalStorage
                const data = 'x'.repeat(10 * 1024 * 1024); // 10MB
                localStorage.setItem('testData', data);
                showStatus('ุชู ููุก LocalStorage ุจูุฌุงุญ', 'success');
            } catch (error) {
                showStatus(`ุชู ุงูุชุดุงู ุฎุทุฃ LocalStorage: ${error.message}`, 'error');
            }
        }
        
        function testNetworkOffline() {
            showStatus('ุงุฎุชุจุงุฑ ุญุงูุฉ ุงูุดุจูุฉ...', 'info');
            const isOnline = navigator.onLine;
            if (isOnline) {
                showStatus('ุงูุดุจูุฉ ูุชุตูุฉ', 'success');
            } else {
                showStatus('ุงูุดุจูุฉ ุบูุฑ ูุชุตูุฉ', 'error');
            }
        }
        
        function testSlowFirebase() {
            showStatus('ุงุฎุชุจุงุฑ Firebase ุจุทูุก...', 'info');
            // ูุญุงูุงุฉ ุงุณุชุฏุนุงุก Firebase ุจุทูุก
            const start = performance.now();
            setTimeout(() => {
                const end = performance.now();
                const duration = end - start;
                if (duration > 3000) {
                    showStatus(`ุชู ุงูุชุดุงู Firebase ุจุทูุก: ${duration.toFixed(2)}ms`, 'error');
                } else {
                    showStatus(`Firebase ุทุจูุนู: ${duration.toFixed(2)}ms`, 'success');
                }
            }, 3500);
        }
        
        // ๐ ุงุฎุชุจุงุฑุงุช ุงูุฃุฏุงุก
        function testPerformance() {
            showStatus('ุงุฎุชุจุงุฑ ุงูุฃุฏุงุก...', 'info');
            const report = window.getSystemReport?.();
            if (report) {
                showStatus('ุชูุฑูุฑ ุงูุฃุฏุงุก ูุชุงุญ', 'success');
                console.log('Performance Report:', report);
            } else {
                showStatus('ุชูุฑูุฑ ุงูุฃุฏุงุก ุบูุฑ ูุชุงุญ', 'error');
            }
        }
        
        function testMemoryUsage() {
            showStatus('ุงุฎุชุจุงุฑ ุงุณุชุฎุฏุงู ุงูุฐุงูุฑุฉ...', 'info');
            if (performance.memory) {
                const memory = performance.memory;
                const used = (memory.usedJSHeapSize / 1024 / 1024).toFixed(2);
                const total = (memory.totalJSHeapSize / 1024 / 1024).toFixed(2);
                showStatus(`ุงุณุชุฎุฏุงู ุงูุฐุงูุฑุฉ: ${used}MB / ${total}MB`, 'success');
            } else {
                showStatus('ูุนูููุงุช ุงูุฐุงูุฑุฉ ุบูุฑ ูุชุงุญุฉ', 'error');
            }
        }
        
        function testUserActions() {
            showStatus('ุงุฎุชุจุงุฑ ุฅุฌุฑุงุกุงุช ุงููุณุชุฎุฏู...', 'info');
            const report = window.getSystemReport?.();
            if (report && report.recentActions) {
                showStatus(`ุขุฎุฑ ${report.recentActions.length} ุฅุฌุฑุงุก ูููุณุชุฎุฏู`, 'success');
                console.log('User Actions:', report.recentActions);
            } else {
                showStatus('ุฅุฌุฑุงุกุงุช ุงููุณุชุฎุฏู ุบูุฑ ูุชุงุญุฉ', 'error');
            }
        }
        
        // ๐ง ุงุฎุชุจุงุฑุงุช ุงูุชุนุงูู
        function testAutoRecovery() {
            showStatus('ุงุฎุชุจุงุฑ ุงูุชุนุงูู ุงูุชููุงุฆู...', 'info');
            // ูุญุงูุงุฉ ุฎุทุฃ ุซู ุงูุชุนุงูู
            setTimeout(() => {
                try {
                    const obj = null;
                    obj.property = 'test';
                } catch (error) {
                    showStatus(`ุชู ุงูุชุดุงู ุงูุฎุทุฃ: ${error.message}`, 'error');
                    // ูุญุงูุงุฉ ุงูุชุนุงูู
                    setTimeout(() => {
                        showStatus('ุชู ุงูุชุนุงูู ุงูุชููุงุฆู ูู ุงูุฎุทุฃ', 'success');
                    }, 1000);
                }
            }, 100);
        }
        
        function testElementRecreation() {
            showStatus('ุงุฎุชุจุงุฑ ุฅุนุงุฏุฉ ุฅูุดุงุก ุงูุนูุงุตุฑ...', 'info');
            // ุฅุฒุงูุฉ ุนูุตุฑ ุซู ูุญุงููุฉ ุฅุนุงุฏุฉ ุฅูุดุงุฆู
            const slider = document.getElementById('bannerSlider');
            if (slider) {
                slider.remove();
                showStatus('ุชู ุฅุฒุงูุฉ ุนูุตุฑ bannerSlider', 'info');
                setTimeout(() => {
                    // ูุญุงููุฉ ุฅุนุงุฏุฉ ุงูุฅูุดุงุก
                    if (window.errorDetectionSystem) {
                        window.errorDetectionSystem.recreateElement('bannerSlider');
                        showStatus('ุชู ุฅุนุงุฏุฉ ุฅูุดุงุก ุงูุนูุตุฑ', 'success');
                    }
                }, 1000);
            } else {
                showStatus('ุนูุตุฑ bannerSlider ุบูุฑ ููุฌูุฏ', 'error');
            }
        }
        
        function testFallbackMode() {
            showStatus('ุงุฎุชุจุงุฑ ูุถุน ุงูุงุญุชูุงุท...', 'info');
            // ูุญุงูุงุฉ ูุดู Firebase
            if (window.errorDetectionSystem) {
                const mockError = {
                    type: 'FIREBASE_ERROR',
                    message: 'Simulated Firebase connection failure',
                    timestamp: new Date().toISOString()
                };
                window.errorDetectionSystem.logError(mockError);
                showStatus('ุชู ูุญุงูุงุฉ ุฎุทุฃ Firebase', 'success');
            } else {
                showStatus('ูุธุงู ุงูุชุดุงู ุงูุฃุฎุทุงุก ุบูุฑ ูุชุงุญ', 'error');
            }
        }
        
        // ๐ ุนุฑุถ ุงูุชูุงุฑูุฑ
        function showSystemReport() {
            showStatus('ุฌุงุฑู ุชุญููู ุชูุฑูุฑ ุงููุธุงู...', 'info');
            const report = window.getSystemReport?.();
            if (report) {
                showStatus('ุชู ุชุญููู ุชูุฑูุฑ ุงููุธุงู ุจูุฌุงุญ', 'success');
                console.log('=== ุชูุฑูุฑ ุงููุธุงู ===');
                console.log(JSON.stringify(report, null, 2));
                console.log('=== ููุงูุฉ ุงูุชูุฑูุฑ ===');
            } else {
                showStatus('ุชูุฑูุฑ ุงููุธุงู ุบูุฑ ูุชุงุญ', 'error');
            }
        }
        
        function clearErrors() {
            showStatus('ุฌุงุฑู ูุณุญ ุงูุฃุฎุทุงุก...', 'info');
            if (window.clearSystemErrors) {
                window.clearSystemErrors();
                showStatus('ุชู ูุณุญ ุงูุฃุฎุทุงุก ุจูุฌุงุญ', 'success');
            } else {
                showStatus('ูุธููุฉ ูุณุญ ุงูุฃุฎุทุงุก ุบูุฑ ูุชุงุญุฉ', 'error');
            }
        }
        
        function exportReport() {
            showStatus('ุฌุงุฑู ุชุตุฏูุฑ ุงูุชูุฑูุฑ...', 'info');
            const report = window.getSystemReport?.();
            if (report) {
                const reportText = JSON.stringify(report, null, 2);
                const blob = new Blob([reportText], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `error-report-${new Date().toISOString().split('T')[0]}.json`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
                showStatus('ุชู ุชุตุฏูุฑ ุงูุชูุฑูุฑ ุจูุฌุงุญ', 'success');
            } else {
                showStatus('ุงูุชูุฑูุฑ ุบูุฑ ูุชุงุญ ููุชุตุฏูุฑ', 'error');
            }
        }
        
        // ๐ ุนุฑุถ ุงูุญุงูุฉ
        function showStatus(message, type) {
            const status = document.getElementById('status');
            status.textContent = message;
            status.className = `status ${type}`;
            status.style.display = 'block';
            
            // ุฅุฎูุงุก ุงูุฑุณุงูุฉ ุจุนุฏ 5 ุซูุงูู
            setTimeout(() => {
                status.style.display = 'none';
            }, 5000);
        }
        
        // ๐ ุชููุฆุฉ ุงูุตูุญุฉ
        document.addEventListener('DOMContentLoaded', function() {
            showStatus('ุตูุญุฉ ุงูุงุฎุชุจุงุฑ ุฌุงูุฒุฉ', 'success');
            console.log('๐งช Error Detection Test Page Loaded');
            console.log('๐ก ุงุถุบุท ุนูู ุงูุฃุฒุฑุงุฑ ูุงุฎุชุจุงุฑ ุงููุธุงู');
        });
    </script>
</body>
</html>
